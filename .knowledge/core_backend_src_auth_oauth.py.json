{"is_source_file": true, "format": "Python", "description": "This file provides utility classes and functions for handling OAuth authorization flows, including building redirect URIs, validating state parameters, parsing callback parameters, and handling errors.", "external_files": ["os", "secrets", "urllib.parse"], "external_methods": ["os.getenv", "secrets.token_urlsafe", "urlencode", "urlparse", "parse_qs"], "published": ["oauth_helper", "create_oauth_session_data", "validate_oauth_callback"], "classes": [{"name": "OAuthHelper", "description": "Helper class for OAuth operations such as generating state, building redirect URLs, and parsing callback parameters."}], "methods": [{"name": "str generate_state(self)", "description": "Generates a secure random state parameter for OAuth.", "scope": "OAuthHelper", "scopeKind": "class"}, {"name": "str build_redirect_uri(self, provider: str)", "description": "Builds OAuth redirect URI for a specific provider.", "scope": "OAuthHelper", "scopeKind": "class"}, {"name": "str build_authorize_url(self, base_url: str, params: Dict[str, Any])", "description": "Builds authorization URL with query parameters.", "scope": "OAuthHelper", "scopeKind": "class"}, {"name": "bool validate_state(self, received_state: str, expected_state: str)", "description": "Validates OAuth state parameter to prevent CSRF attacks.", "scope": "OAuthHelper", "scopeKind": "class"}, {"name": "Dict[str,Any] parse_callback_params(self, callback_url: str)", "description": "Parses parameters from OAuth callback URL.", "scope": "OAuthHelper", "scopeKind": "class"}, {"name": "Optional[str] handle_callback_error(self, params: Dict[str, Any])", "description": "Handles OAuth callback errors.", "scope": "OAuthHelper", "scopeKind": "class"}, {"name": "Dict[str,Any] create_oauth_session_data(provider: str, state: str, user_id: Optional[int] = None)", "description": "Creates session data for OAuth flow.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] validate_oauth_callback(params: Dict[str, Any], expected_state: str)", "description": "Validates OAuth callback parameters, checking for errors, matching state, and presence of authorization code.", "scope": "", "scopeKind": ""}, {"name": "__init__(self)", "scope": "OAuthHelper", "scopeKind": "class", "description": "unavailable"}], "calls": ["os.getenv", "secrets.token_urlsafe", "urlencode", "urlparse", "parse_qs", "oauth_helper.handle_callback_error", "oauth_helper.validate_state"], "search-terms": ["OAuthHelper", "oauth_callback", "OAuth utilities", "build_authorize_url", "validate_oauth_callback"], "state": 2, "file_id": 29, "knowledge_revision": 89, "git_revision": "", "revision_history": [{"76": ""}, {"89": ""}], "ctags": [{"_type": "tag", "name": "OAuthHelper", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^class OAuthHelper:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^    def __init__(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "OAuthHelper", "scopeKind": "class"}, {"_type": "tag", "name": "build_authorize_url", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^    def build_authorize_url(self, base_url: str, params: Dict[str, Any]) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, base_url: str, params: Dict[str, Any])", "scope": "OAuthHelper", "scopeKind": "class"}, {"_type": "tag", "name": "build_redirect_uri", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^    def build_redirect_uri(self, provider: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, provider: str)", "scope": "OAuthHelper", "scopeKind": "class"}, {"_type": "tag", "name": "create_oauth_session_data", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^def create_oauth_session_data(provider: str, state: str, user_id: Optional[int] = None) -> Dict[/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(provider: str, state: str, user_id: Optional[int] = None)"}, {"_type": "tag", "name": "generate_state", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^    def generate_state(self) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self)", "scope": "OAuthHelper", "scopeKind": "class"}, {"_type": "tag", "name": "handle_callback_error", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^    def handle_callback_error(self, params: Dict[str, Any]) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "member", "signature": "(self, params: Dict[str, Any])", "scope": "OAuthHelper", "scopeKind": "class"}, {"_type": "tag", "name": "oauth_helper", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^oauth_helper = OAuthHelper()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "parse_callback_params", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^    def parse_callback_params(self, callback_url: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, callback_url: str)", "scope": "OAuthHelper", "scopeKind": "class"}, {"_type": "tag", "name": "validate_oauth_callback", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^def validate_oauth_callback(params: Dict[str, Any], expected_state: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(params: Dict[str, Any], expected_state: str)"}, {"_type": "tag", "name": "validate_state", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^    def validate_state(self, received_state: str, expected_state: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, received_state: str, expected_state: str)", "scope": "OAuthHelper", "scopeKind": "class"}], "hash": "d7f38a2a511e68a51a5c2eaa41dcf561", "format-version": 4, "code-base-name": "core_backend", "filename": "core_backend/src/auth/oauth.py", "fields": [{"name": "oauth_helper = OAuthHelper()", "scope": "", "scopeKind": "", "description": "unavailable"}]}