{"is_source_file": true, "format": "Python", "description": "This file contains utility classes and functions for handling OAuth authorization flows, including generating and verifying signed state tokens, constructing redirect URIs, parsing callback parameters, and managing OAuth session data.", "external_files": ["src.config"], "external_methods": ["settings.frontend_base_url", "settings.jwt_secret"], "published": ["create_oauth_session_data", "validate_oauth_callback", "oauth_helper"], "classes": [{"name": "OAuthHelper", "description": "Helper class for OAuth operations with signed state support, providing methods for generating signed state tokens, verifying them, building redirect URIs, parsing callback parameters, and handling errors."}], "methods": [{"name": "str generate_state(self, connector_key: Optional[str] = None, connection_id: Optional[int] = None, ttl_seconds: int = 600)", "description": "Generates a signed, expiring OAuth state token with optional connector key and connection ID.", "scope": "OAuthHelper", "scopeKind": "class"}, {"name": "Dict[str,Any] verify_state(self, state: str)", "description": "Verifies the authenticity and validity of a signed OAuth state token and returns its payload.", "scope": "OAuthHelper", "scopeKind": "class"}, {"name": "str build_redirect_uri(self, provider: str)", "description": "Constructs the OAuth redirect URI used for callbacks, based on the provider.", "scope": "OAuthHelper", "scopeKind": "class"}, {"name": "str build_authorize_url(self, base_url: str, params: Dict[str, Any])", "description": "Builds the authorization URL with specified parameters for OAuth provider.", "scope": "OAuthHelper", "scopeKind": "class"}, {"name": "Dict[str,Any] parse_callback_params(self, callback_url: str)", "description": "Parses callback URL parameters into a dictionary.", "scope": "OAuthHelper", "scopeKind": "class"}, {"name": "Optional[str] handle_callback_error(self, params: Dict[str, Any])", "description": "Handles OAuth callback errors, returning an error message if present.", "scope": "OAuthHelper", "scopeKind": "class"}, {"name": "Dict[str,Any] create_oauth_session_data(provider: str, state: str, user_id: Optional[int] = None)", "description": "Creates session data for OAuth flow, embedding provider, state, and optional user ID.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] validate_oauth_callback(params: Dict[str, Any])", "description": "Validates OAuth callback parameters, verifying the signed state and extracting relevant data.", "scope": "", "scopeKind": ""}, {"name": "__init__(self)", "scope": "OAuthHelper", "scopeKind": "class", "description": "unavailable"}, {"name": "str _b64url(data: bytes)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bytes _b64url_decode(data: str)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["hmac.new", "_b64url", "_b64url_decode", "json.loads", "datetime.now", "hashlib.sha256", "urlencode", "urlparse", "parse_qs"], "search-terms": ["OAuthHelper", "signed state token", "OAuth callback", "build_authorize_url", "verify_state", "generate_state", "oauth_callback", "session_data"], "state": 2, "file_id": 29, "knowledge_revision": 131, "git_revision": "2ec6dddd09bed28218dc8f9df2e7ee65406d9d04", "revision_history": [{"76": ""}, {"89": ""}, {"131": "2ec6dddd09bed28218dc8f9df2e7ee65406d9d04"}], "ctags": [{"_type": "tag", "name": "OAuthHelper", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^class OAuthHelper:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^    def __init__(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "OAuthHelper", "scopeKind": "class"}, {"_type": "tag", "name": "_b64url", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^def _b64url(data: bytes) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(data: bytes)"}, {"_type": "tag", "name": "_b64url_decode", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^def _b64url_decode(data: str) -> bytes:$/", "language": "Python", "typeref": "typename:bytes", "kind": "function", "signature": "(data: str)"}, {"_type": "tag", "name": "build_authorize_url", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^    def build_authorize_url(self, base_url: str, params: Dict[str, Any]) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, base_url: str, params: Dict[str, Any])", "scope": "OAuthHelper", "scopeKind": "class"}, {"_type": "tag", "name": "build_redirect_uri", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^    def build_redirect_uri(self, provider: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, provider: str)", "scope": "OAuthHelper", "scopeKind": "class"}, {"_type": "tag", "name": "create_oauth_session_data", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^def create_oauth_session_data(provider: str, state: str, user_id: Optional[int] = None) -> Dict[/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(provider: str, state: str, user_id: Optional[int] = None)"}, {"_type": "tag", "name": "generate_state", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^    def generate_state(self, connector_key: Optional[str] = None, connection_id: Optional[int] =/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, connector_key: Optional[str] = None, connection_id: Optional[int] = None, ttl_seconds: int = 600)", "scope": "OAuthHelper", "scopeKind": "class"}, {"_type": "tag", "name": "handle_callback_error", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^    def handle_callback_error(self, params: Dict[str, Any]) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "member", "signature": "(self, params: Dict[str, Any])", "scope": "OAuthHelper", "scopeKind": "class"}, {"_type": "tag", "name": "oauth_helper", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^oauth_helper = OAuthHelper()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "parse_callback_params", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^    def parse_callback_params(self, callback_url: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, callback_url: str)", "scope": "OAuthHelper", "scopeKind": "class"}, {"_type": "tag", "name": "validate_oauth_callback", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^def validate_oauth_callback(params: Dict[str, Any]) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(params: Dict[str, Any])"}, {"_type": "tag", "name": "verify_state", "path": "/home/kavia/workspace/code-generation/connector-framework-manager-147069-147079/core_backend/src/auth/oauth.py", "pattern": "/^    def verify_state(self, state: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, state: str)", "scope": "OAuthHelper", "scopeKind": "class"}], "hash": "c9a21f6a0e1cddf8fcc7a42179a64e7c", "format-version": 4, "code-base-name": "core_backend", "filename": "core_backend/src/auth/oauth.py", "fields": [{"name": "oauth_helper = OAuthHelper()", "scope": "", "scopeKind": "", "description": "unavailable"}]}